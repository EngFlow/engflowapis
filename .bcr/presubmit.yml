# Keep in sync with .github/workflows/main.yml
matrix:
  # Search for `PLATFORMS =` in:
  # https://github.com/bazelbuild/continuous-integration/blob/master/buildkite/bazelci.py
  platform:
    - "debian13"
    - "ubuntu2404"
    - "macos"
    - "macos_arm64"
    - "windows"
  bazel:
    - "9.x"
    - "8.x"
    - "7.x"
    - "rolling"
    - "last_green"

tasks:
  verify_targets:
    name: "Verify build targets"
    platform: ${{ platform }}
    bazel: ${{ bazel }}
    build_targets:
      - "//..."

incompatible_flags:
  # Disabled because of a transitive dependency on `rules_foreign_cc` that is
  # incompatible.
  "--incompatible_autoload_externally=":
    - "7.x"
